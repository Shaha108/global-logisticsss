<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galaxy Courier | TSP Challenge</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #0f0c29;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    .game-container {
      max-width: 800px;
      margin: 0 auto;
    }
    .map {
      width: 100%;
      height: 500px;
      background: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=1471&auto=format') center/cover;
      position: relative;
      border: 2px solid #4e54c8;
      border-radius: 10px;
      margin: 20px 0;
    }
    .node {
      width: 20px;
      height: 20px;
      background: #f5af19;
      border-radius: 50%;
      position: absolute;
      cursor: pointer;
      box-shadow: 0 0 10px #f5af19;
    }
    .edge {
      position: absolute;
      height: 2px;
      background: rgba(78, 84, 200, 0.5);
      transform-origin: 0 0;
    }
    .controls {
      margin: 20px 0;
    }
    button {
      background: #4e54c8;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 0 10px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #8f94fb;
    }
    #score {
      font-size: 1.2em;
      color: #f5af19;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>🌌 Galaxy Courier</h1>
    <p>Deliver packages across the cosmos with minimal fuel!</p>
    <div class="game-ui">
      <div class="map" id="map"></div>
      <div class="controls">
        <button id="validate-btn">Validate Route</button>
        <button id="reset-btn">Reset</button>
        <span id="score">Fuel used: 0</span>
      </div>
    </div>
  </div>

  <script>
    // Game Config
    const NODES = 8;
    const FUEL_MULTIPLIER = 10;

    // DOM Elements
    const mapEl = document.getElementById('map');
    const validateBtn = document.getElementById('validate-btn');
    const resetBtn = document.getElementById('reset-btn');
    const scoreEl = document.getElementById('score');

    // Game State
    let nodes = [];
    let edges = [];
    let selectedRoute = [];
    let totalFuel = 0;

    // Initialize the game
    function init() {
      createNodes();
      createEdges();
      renderEdges();
      setupEventListeners();
    }

    // Create random nodes (planets)
    function createNodes() {
      const mapWidth = mapEl.offsetWidth;
      const mapHeight = mapEl.offsetHeight;

      for (let i = 0; i < NODES; i++) {
        const node = {
          id: i,
          x: Math.random() * (mapWidth - 40) + 20,
          y: Math.random() * (mapHeight - 40) + 20
        };
        nodes.push(node);

        const nodeEl = document.createElement('div');
        nodeEl.className = 'node';
        nodeEl.style.left = `${node.x}px`;
        nodeEl.style.top = `${node.y}px`;
        nodeEl.dataset.id = i;
        mapEl.appendChild(nodeEl);
      }
    }

    // Create edges (warp lanes) between all nodes
    function createEdges() {
      for (let i = 0; i < nodes.length; i++) {
        for (let j = i + 1; j < nodes.length; j++) {
          edges.push({
            from: nodes[i],
            to: nodes[j],
            cost: calculateDistance(nodes[i], nodes[j]) * FUEL_MULTIPLIER
          });
        }
      }
    }

    // Calculate Euclidean distance between two points
    function calculateDistance(a, b) {
      return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));
    }

    // Render edges (faint lines)
    function renderEdges() {
      edges.forEach(edge => {
        const edgeEl = document.createElement('div');
        edgeEl.className = 'edge';
        edgeEl.style.width = `${calculateDistance(edge.from, edge.to)}px`;
        edgeEl.style.left = `${edge.from.x}px`;
        edgeEl.style.top = `${edge.from.y}px`;
        edgeEl.style.transform = `rotate(${Math.atan2(edge.to.y - edge.from.y, edge.to.x - edge.from.x)}rad)`;
        mapEl.appendChild(edgeEl);
      });
    }

    // Event Listeners
    function setupEventListeners() {
      document.querySelectorAll('.node').forEach(node => {
        node.addEventListener('click', () => {
          const nodeId = parseInt(node.dataset.id);
          if (!selectedRoute.includes(nodeId)) {
            selectedRoute.push(nodeId);
            node.style.background = '#4e54c8';
            updateRoute();
          }
        });
      });

      validateBtn.addEventListener('click', validateRoute);
      resetBtn.addEventListener('click', resetGame);
    }

    // Update the visual route
    function updateRoute() {
      // Clear previous route highlights
      document.querySelectorAll('.edge').forEach(edge => edge.style.background = 'rgba(78, 84, 200, 0.5)');

      // Calculate and highlight new route
      totalFuel = 0;
      for (let i = 0; i < selectedRoute.length - 1; i++) {
        const fromNode = nodes[selectedRoute[i]];
        const toNode = nodes[selectedRoute[i + 1]];
        const edge = edges.find(e => 
          (e.from.id === fromNode.id && e.to.id === toNode.id) || 
          (e.from.id === toNode.id && e.to.id === fromNode.id)
        );
        if (edge) {
          totalFuel += edge.cost;
          const edgeEl = document.querySelector(`.edge[style*="left: ${fromNode.x}px"][style*="top: ${fromNode.y}px"]`);
          if (edgeEl) edgeEl.style.background = '#f5af19';
        }
      }
      scoreEl.textContent = `Fuel used: ${totalFuel.toFixed(2)}`;
    }

    // Validate the route (must visit all nodes and return to start)
    function validateRoute() {
      if (selectedRoute.length === 0) {
        alert("🚀 Plot a route first!");
        return;
      }

      const uniqueNodes = new Set(selectedRoute);
      if (uniqueNodes.size !== NODES) {
        alert("⚠️ Visit ALL planets before returning!");
      } else if (selectedRoute[0] !== selectedRoute[selectedRoute.length - 1]) {
        alert("⛔ You must return to your starting planet!");
      } else {
        alert(`✅ Mission success! Fuel used: ${totalFuel.toFixed(2)}. Lower is better!`);
      }
    }

    // Reset the game
    function resetGame() {
      selectedRoute = [];
      totalFuel = 0;
      scoreEl.textContent = "Fuel used: 0";
      document.querySelectorAll('.node').forEach(node => {
        node.style.background = '#f5af19';
      });
      document.querySelectorAll('.edge').forEach(edge => {
        edge.style.background = 'rgba(78, 84, 200, 0.5)';
      });
    }

    // Start the game
    init();
  </script>
</body>
</html>
